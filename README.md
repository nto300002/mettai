# 滅諦（Mettai）— ビジネス要件定義書

> **文書種別:** ビジネス要件定義書（MVP）  
> **バージョン:** v2.0  
> **作成日:** 2026年2月11日  
> **ステータス:** Draft  
> **対応ブラウザ:** Google Chrome / Mozilla Firefox

---

## 1. プロダクト概要

### 1.1 プロダクトビジョン

滅諦（Mettai）は、ADHD当事者が集中作業中に発生する衝動（許可外Webサイトへの逃避行動）に対して、**ブロックではなく「気づき」**を提供するブラウザ拡張機能である。

仏教の「滅諦」（苦の消滅）の思想に基づき、衝動を悪として排除するのではなく、「ただの現象」として観察し受け流すアプローチを採用する。

### 1.2 解決する課題

ADHD当事者の集中における3つの課題を解決する。

1. **自動操縦的な衝動** — 作業中に無意識でSNS・動画サイトを開いてしまう
2. **完全ブロックの逆効果** — ブロック型ツールでは抜け道を探す衝動が新たに発生する
3. **自己否定の悪循環** — 「またやってしまった」という自責が集中力をさらに低下させる

### 1.3 コアコンセプト

**ブロックではなく気づき。** ユーザーが許可外サイトを開いた瞬間に5秒間の「間（ま）」を作り、自動操縦状態を中断する。ユーザー自身が「戻る」を選択する体験を通じて自己効力感を蓄積し、衝動への耐性を段階的に育てる。

### 1.4 MVPスコープ定義

| 区分 | 項目 | MVP対象 |
|------|------|---------|
| 機能 | ホワイトリスト/ブラックリストによるURL制限 | ✅ |
| 機能 | キーワード部分一致・ドメイン一致・正規表現マッチング | ✅ |
| 機能 | 衝動検知時のオーバーレイ（5秒カウントダウン） | ✅ |
| 機能 | 集中モードON/OFF切替 | ✅ |
| 機能 | 5分間の一時許可 | ✅ |
| 機能 | ユーザー認証（登録・ログイン） | ✅ |
| 機能 | URLルールのCRUD管理 | ✅ |
| 機能 | 衝動ログの記録・分析 | ❌ v2以降 |
| 機能 | ノイズ処理（自我の声の記録） | ❌ v2以降 |
| 機能 | 継続ストリーク・統計ダッシュボード | ❌ v2以降 |
| 機能 | AI分析エンジン | ❌ v2以降 |
| 対応 | Google Chrome | ✅ |
| 対応 | Mozilla Firefox | ✅ |
| 対応 | Safari / Edge | ❌ v2以降 |

---

## 2. ターゲットユーザー

### 2.1 プライマリペルソナ

| 項目 | 内容 |
|------|------|
| 属性 | ADHD当事者（診断済み or 自覚あり）のエンジニア・クリエイター |
| 年齢層 | 20〜40代 |
| 技術リテラシー | 中〜高（ブラウザ拡張のインストールに抵抗がない） |
| 課題 | コーディング中にTwitter/YouTube/Redditを無意識に開いてしまう |
| 既存対策 | Forest, Cold Turkey等を試したが「完全ブロック」が合わなかった |
| 求めるもの | 責められずに、自分で気づいて戻れる体験 |

### 2.2 セカンダリペルソナ

ADHD非当事者だが集中力に課題を感じているナレッジワーカー。ポモドーロ等の時間管理手法と併用し、作業時間中の脱線防止ツールとして利用する。

---

## 3. 競合分析と差別化

| ツール | アプローチ | ADHD適性 | 滅諦との差異 |
|--------|-----------|----------|-------------|
| Cold Turkey | 完全ブロック | △ 抜け道を探す衝動が発生 | 気づきベース。ブロックしない |
| Forest | ゲーミフィケーション（木を育てる） | ○ 報酬系に訴求 | 内省的。罰/報酬ではなく観察 |
| Freedom | マルチデバイスブロック | △ 強制力が高すぎる | 自己選択を尊重 |
| LeechBlock | スケジュール制限 | △ 設定が複雑 | シンプル。キーワード1語で制限可能 |
| Focusmate | 他者の目による集中 | ○ 外発的動機 | 内発的気づきにフォーカス |

### 滅諦のポジショニング

```
                強制力 高
                  │
     Cold Turkey  │  Freedom
                  │
  設定が複雑 ─────┼───────── 設定がシンプル
                  │
     LeechBlock   │  ★ 滅諦（Mettai）
                  │
                強制力 低
```

滅諦は「**設定がシンプル × 強制力が低い（気づきベース）**」という独自のポジションを取る。完全ブロック型ツールで挫折したADHD当事者が次に試すツールとして位置づける。

---

## 4. ビジネスモデル

MVPはオープンソースとして無料公開し、ユーザーフィードバックを収集する。

| ティア | 価格 | 機能 |
|--------|------|------|
| Free | 無料 | ホワイトリスト/ブラックリスト、オーバーレイ通知、基本設定 |
| Pro（将来） | 月額500円程度 | 衝動ログ分析、ノイズ処理、週次レポート、AIリフレーミング |

### マネタイズへの移行条件

Proプランの導入はDAU 500ユーザー以上、かつ衝動ログ機能へのリクエストが一定数に達した時点で検討する。ユーザーの「無料で使い続けたい」という声も重要な指標とし、無料版の機能を削ることはしない。

---

## 5. 成功指標（KPI）

| 指標 | MVP目標 | 測定方法 |
|------|---------|----------|
| 拡張インストール数 | 100ユーザー（3ヶ月） | Chrome/Firefox ストア統計 |
| DAU（日次アクティブ） | 30% | 集中モードON率 |
| 衝動時の「戻る」選択率 | 60%以上 | v2以降のログ分析で測定 |
| 1週間継続率 | 40%以上 | 登録後7日間のアクティブ率 |
| NPS（推奨度） | +20以上 | ユーザーアンケート（v1.1以降） |

### MVP段階での測定可能な指標

MVP段階では衝動ログを保存しないため、定量的な行動データは取得できない。代わりに以下で検証する。

- **ストアレビューとフィードバック** — 質的データとして収集
- **インストール数 / アンインストール率** — ストア統計から取得
- **GitHub Issues / Discussions** — 機能リクエストとバグ報告の傾向

---

## 6. ユーザーストーリー

### US-01: アカウント作成

- **ストーリー:** 新規ユーザーとして、メールアドレスとパスワードでアカウントを作成し、拡張機能にログインしたい。
- **優先度:** Must
- **受入条件:** メール+パスワードで登録完了後、トークンが発行され拡張機能に保存される

### US-02: 制限モード選択

- **ストーリー:** ユーザーとして、ブラックリストモード（特定URLを制限）またはホワイトリストモード（特定URLのみ許可）を選択したい。
- **優先度:** Must
- **受入条件:** 設定画面でモード切替が可能。デフォルトはブラックリストモード

### US-03: キーワードによるURL制限

- **ストーリー:** ユーザーとして、「youtube」というキーワードを登録するだけでYouTube関連の全URLを制限したい。
- **優先度:** Must
- **受入条件:** キーワード部分一致でURL全体を検索し、含まれていれば制限対象となる

### US-04: ドメインによるURL制限

- **ストーリー:** ユーザーとして、「x.com」のようにドメイン指定でサイトを制限/許可したい。
- **優先度:** Must
- **受入条件:** ドメイン一致（www付き、サブドメイン含む）でマッチング

### US-05: 正規表現によるURL制限

- **ストーリー:** 上級ユーザーとして、正規表現で細かいURL制限ルールを定義したい。
- **優先度:** Should
- **受入条件:** 有効な正規表現パターンでURL全体をマッチング。不正な正規表現は無視される

### US-06: 集中モードの切替

- **ストーリー:** ユーザーとして、拡張機能のポップアップから集中モードをON/OFFしたい。
- **優先度:** Must
- **受入条件:** トグルスイッチで即座に切替。OFFの間はタブ監視を行わない

### US-07: 衝動検知と気づきオーバーレイ

- **ストーリー:** 集中モード中に許可外サイトを開いたとき、画面に気づきのオーバーレイが表示されてほしい。
- **優先度:** Must
- **受入条件:** 5秒カウントダウン後に選択肢が表示される。即座にブロックはしない

### US-08: 作業への帰還

- **ストーリー:** オーバーレイで「作業に戻る」を選択したとき、前のタブに戻りたい。
- **優先度:** Must
- **受入条件:** 「作業に戻る」クリックで前のタブにフォーカスが移動しオーバーレイが消える

### US-09: 5分間の一時許可

- **ストーリー:** オーバーレイで「5分だけ許可」を選択したとき、該当URLが5分間制限対象外になってほしい。
- **優先度:** Must
- **受入条件:** 5分経過後に再度タブ監視対象に戻る

### US-10: ルールの管理

- **ストーリー:** ユーザーとして、登録したURLルールを一覧表示・編集・削除したい。
- **優先度:** Must
- **受入条件:** 拡張ポップアップまたはWeb管理画面からCRUD操作が可能

### US-11: ルールの自動同期

- **ストーリー:** 拡張機能にログインしたら、サーバーに保存されたルールが自動同期されてほしい。
- **優先度:** Must
- **受入条件:** 5分間隔でAPIからルールを取得しローカルキャッシュを更新

---

## 7. URLマッチングルール仕様

### 7.1 マッチタイプ

| マッチタイプ | 入力例 | マッチ対象 | マッチ方法 |
|-------------|--------|-----------|-----------|
| keyword（部分一致） | `youtube` | URL全体 | 大文字小文字を無視し、URLのどこかに含まれればマッチ |
| domain（ドメイン一致） | `github.com` | ホスト名 | 完全一致 + www.付き + サブドメインに対応 |
| domain（ワイルドカード） | `*.notion.so` | ホスト名 | 指定ドメインのサブドメインにマッチ |
| regex（正規表現） | `reddit\.com/(r/\|user/)` | URL全体 | 大文字小文字無視の正規表現マッチ |

### 7.2 動作モード

| モード | ルールにマッチした場合 | ルールにマッチしない場合 | 想定ユースケース |
|--------|----------------------|------------------------|----------------|
| ブラックリスト | 制限（オーバーレイ表示） | 通過 | 特定の誘惑サイトだけ制限したい |
| ホワイトリスト | 通過 | 制限（オーバーレイ表示） | 作業に必要なサイトだけ許可したい |

### 7.3 マッチング例

**ブラックリストモード（ルール: `youtube` / keyword）**

| URL | 結果 | 理由 |
|-----|------|------|
| `https://www.youtube.com/watch?v=abc` | 🚫 制限 | "youtube" を含む |
| `https://m.youtube.com/shorts/xyz` | 🚫 制限 | "youtube" を含む |
| `https://youtube.googleapis.com/` | 🚫 制限 | "youtube" を含む |
| `https://docs.djangoproject.com/` | ✅ 通過 | "youtube" を含まない |
| `https://github.com/yasuda/mettai` | ✅ 通過 | "youtube" を含まない |

---

## 8. リスクと対策

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| ユーザーが拡張機能自体を無効化して回避する | 高 | 高 | 想定内。強制しないのがコンセプト。無効化→再有効化の体験も含めて設計 |
| オーバーレイが特定サイトで正常表示されない | 中 | 中 | content_scripts の互換性テストを主要サイトで実施 |
| APIサーバーダウン時に拡張が動作しない | 高 | 低 | ローカルキャッシュで動作継続する設計（オフラインファースト） |
| Chrome拡張のManifest V3移行による仕様変更 | 中 | 低 | Service Worker互換コードで実装済み |
| ユーザーが「気づきだけでは不十分」と感じる | 中 | 中 | v2で衝動ログ・統計機能を追加し、成長の可視化を提供 |

---

## 9. 用語集

| 用語 | 定義 |
|------|------|
| 滅諦（めったい） | 仏教の四聖諦の第三。苦（ドゥッカ）の消滅。本アプリでは衝動という「苦」への気づきと消滅を意味する |
| 衝動 | 集中作業中に発生する、許可外Webサイトを開こうとする無意識の行動 |
| オーバーレイ | 許可外サイトを開いた際に画面全体に表示される気づきのUI |
| 間（ま） | 衝動と行動の間に設ける5秒間の一時停止。自動操縦を中断する目的 |
| ホワイトリストモード | 登録されたURLのみ許可し、それ以外を全て制限するモード |
| ブラックリストモード | 登録されたURLのみ制限し、それ以外を全て許可するモード |
| 一時許可 | オーバーレイで「5分だけ許可」を選択した際に、該当URLを一定時間制限対象外にする機能 |
| キーワード部分一致 | URL全体に対して指定キーワードが含まれるかを判定するマッチング方式 |# mettai
